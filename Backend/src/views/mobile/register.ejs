<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div>
        <div>
            <div>
                <form id="registerForm" action="/api/auth/register" method="POST">
                    <h1>Registro</h1>
                    <input type="text" name="username" id="username" placeholder="Nombres y Apellidos" required>
                    <input type="email" name="email" id="email" placeholder="Correo Electrónico" required>
                    <input type="password" name="password" id="password" placeholder="Contraseña" required>
                    <input type="password" name="confirmPassword" id="confirmPassword" placeholder="Confirmar Contraseña" required>
                    <input type="tel" name="contact" id="contact" placeholder="Número de Contacto" required>
                    <input type="text" name="vehicles.patente" id="patente" placeholder="Placa del Vehículo" required>
                    <input type="text" name="vehicles.model" id="model" placeholder="Modelo del Vehículo" required>
                    <input type="number" name="vehicles.year" id="year" placeholder="Año del Vehículo" required>
                    <button type="submit">Registrar</button>
                </form>
            </div>
        </div>
    </div>
</body>

<script>
    document.getElementById('registerForm').addEventListener('submit', async (event) => {
        event.preventDefault(); // Evitar que el formulario se envíe de forma convencional.
    
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
    
        if (password !== confirmPassword) {
            alert('Las contraseñas no coinciden. Por favor, inténtalo nuevamente.');
            return; // No enviar el formulario si las contraseñas no coinciden.
        }
    
        const data = {
            username: document.getElementById('username').value,
            email: document.getElementById('email').value,
            password: password,
            contact: document.getElementById('contact').value,
            vehicles: {
                patente: document.getElementById('patente').value,
                model: document.getElementById('model').value,
                year: parseInt(document.getElementById('year').value)
            }
        };
    
        const res = await fetch("http://localhost:3000/api/register", {
            method: "POST",
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
    
        const result = await res.json();
    
        if (result.success) {
            alert('Registro exitoso. Ahora puedes iniciar sesión.');
        } else {
            alert('Error al registrar. Verifica tus datos e inténtalo nuevamente.');
        }
    });

    const express = require('express');
    const app = express();
    const bodyParser = require('body-parser');

    // Middleware para procesar JSON en las solicitudes.
    app.use(bodyParser.json());

    // Ruta para el registro de usuario.
    app.post('/api/auth/register', (req, res) => {
        const { username, email, password, contact, vehicles } = req.body;

        // Realiza las validaciones y el registro de usuario aquí, de acuerdo a los criterios especificados.
        
        // Si el registro es exitoso, responde con un objeto JSON que indique el éxito.
        const success = true;
        if (success) {
            res.json({ success: true });
        } else {
            res.status(400).json({ success: false });
        }
    });

    // Resto de la configuración del servidor...

    const port = 3000;
    app.listen(port, () => {
        console.log(`Servidor en ejecución en el puerto ${port}`);
    });

</script>
</html>